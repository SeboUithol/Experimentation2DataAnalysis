

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Analysing data with Python and MNE &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'EEGDataAnalysis';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Analysing data with Python and MNE</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/SeboUithol/Experimentation2DataAnalysis/main?urlpath=tree/EEGDataAnalysis.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/SeboUithol/Experimentation2DataAnalysis/blob/main/EEGDataAnalysis.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SeboUithol/Experimentation2DataAnalysis" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SeboUithol/Experimentation2DataAnalysis/issues/new?title=Issue%20on%20page%20%2FEEGDataAnalysis.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/EEGDataAnalysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analysing data with Python and MNE</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Analysing data with Python and MNE</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-mne">About MNE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-tutorial">About this tutorial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing">Importing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-data">Loading the data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downsampling">Downsampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rereferencing">Rereferencing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">Filtering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-anlysis">Independent Component Anlysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-again">Filtering again</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-behavioural-data">Loading the behavioural data</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analysing-data-with-python-and-mne">
<h1>Analysing data with Python and MNE<a class="headerlink" href="#analysing-data-with-python-and-mne" title="Permalink to this heading">#</a></h1>
<p><em>Sebo Uithol, PhD, June 2023. Thanks to Jeshua Tromp and David Vogelsang for their help setting up this Jupyter Notebook.</em></p>
<p>Welcome to the practical session EEG data analysis using MNE! This practical session is part of the course Experimentation II at Leiden University. In this session we will study the EEG signals during an Eriksen Flankers Task. We will get acquainted with the basic preprocessing steps, the analysis of the data and the interpretation of the results.</p>
<p>The data that we will be analysing was recorded at Leiden University, with the same equipment that we have used during the data acquisition practical.</p>
<p>The data was acquired during an Eriksen flankers task. This is a conflict task that belongs to the same family of paradigms as the Stroop and Simon task. Participants are instructed to respond as fast as possible to the direction of the central stimulus in an array like this by pressing a response button with the corresponding index finger (in this case the right index finger) The experiment was a bit more complex than the standard Flankers task, but we will ignore this here.</p>
<p>Flanking stimuli around the target are irrelevant, but can prime the correct response (congruent), or the opposite response (incongruent). Immediately after stimulus presentation, the attentional spotlight (the area of stimulus information that is selected for further processing) has not yet been narrowed, so the dominant information derives from the flankers, which may point at the wrong response. As the spotlight is narrowed, the support for the correct response increases. In the ERP you are likely to see initial signs of motor preparation for the hand indicated by the flankers (LRP) and signs of error detection processes (ERN). In addition, the ERP will show large components such as the P300. Prior to the P300, there is a weak negative component that is sensitive to the presence of conflict in the decision processes (N200). We will see to what extent these waves can be identified and quantified.</p>
<section id="about-mne">
<h2>About MNE<a class="headerlink" href="#about-mne" title="Permalink to this heading">#</a></h2>
<p>MNE (MEG &amp; EEG) is a python toolbox. Both python and MNE are free, which makes it an analysis combination that is rapidly gaining ground. Installing and setting it up can be a bit more tricky, though, as there is a web of versions, libraries, dependencies, etc, that can change quickly.</p>
</section>
<section id="about-this-tutorial">
<h2>About this tutorial<a class="headerlink" href="#about-this-tutorial" title="Permalink to this heading">#</a></h2>
<p>This tutorial takes you through the absolute basic steps of EEG data analysis using MNE. MNE has an excellent website (<a class="reference external" href="https://mne.tools/stable/auto_tutorials/index.html">https://mne.tools/stable/auto_tutorials/index.html</a>) with all the commands explained, and also sample scripts showing how these commands can be put to use. I encourage you to look it up, and incorporate the commands you find there in the script below. At the bottom of this tutorial there is room to add your own commants.</p>
</section>
<section id="importing">
<h2>Importing<a class="headerlink" href="#importing" title="Permalink to this heading">#</a></h2>
<p>Before we can start loading the data, we need to have the proper tools in place. Obviously we need to import MNE. Next we import matplotlib, for data visualisation, pandas for data analysis, and numpy for working with data structures. If you don’t like typing the same words over and over again, you can import libraries as a shorter name, for instance ‘pandas’ as ‘pd’. This saves time later on, but it is optional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">pip</span> install mne
<span class="kn">import</span> <span class="nn">mne</span>
<span class="o">%</span><span class="k">pip</span> install python-picard
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: mne in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (1.4.2)
Requirement already satisfied: decorator in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (5.1.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pooch&gt;=1.5 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (1.7.0)
Requirement already satisfied: packaging in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (21.3)
Requirement already satisfied: jinja2 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (2.11.3)
Requirement already satisfied: matplotlib&gt;=3.4.0 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (3.5.2)
Requirement already satisfied: tqdm in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (4.64.1)
Requirement already satisfied: numpy&gt;=1.15.4 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (1.21.5)
Requirement already satisfied: scipy&gt;=1.6.3 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from mne) (1.9.1)
Requirement already satisfied: pillow&gt;=6.2.0 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from matplotlib&gt;=3.4.0-&gt;mne) (9.2.0)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from matplotlib&gt;=3.4.0-&gt;mne) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from matplotlib&gt;=3.4.0-&gt;mne) (2.8.2)
Requirement already satisfied: fonttools&gt;=4.22.0 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from matplotlib&gt;=3.4.0-&gt;mne) (4.25.0)
Requirement already satisfied: cycler&gt;=0.10 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from matplotlib&gt;=3.4.0-&gt;mne) (0.11.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from matplotlib&gt;=3.4.0-&gt;mne) (1.4.2)
Requirement already satisfied: platformdirs&gt;=2.5.0 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from pooch&gt;=1.5-&gt;mne) (2.5.2)
Requirement already satisfied: requests&gt;=2.19.0 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from pooch&gt;=1.5-&gt;mne) (2.28.1)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from jinja2-&gt;mne) (2.0.1)
Requirement already satisfied: six&gt;=1.5 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.4.0-&gt;mne) (1.16.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: certifi&gt;=2017.4.17 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from requests&gt;=2.19.0-&gt;pooch&gt;=1.5-&gt;mne) (2022.9.24)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from requests&gt;=2.19.0-&gt;pooch&gt;=1.5-&gt;mne) (1.26.11)
Requirement already satisfied: charset-normalizer&lt;3,&gt;=2 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from requests&gt;=2.19.0-&gt;pooch&gt;=1.5-&gt;mne) (2.0.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from requests&gt;=2.19.0-&gt;pooch&gt;=1.5-&gt;mne) (3.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: python-picard in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (0.7)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numpy in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from python-picard) (1.21.5)
Requirement already satisfied: numexpr in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from python-picard) (2.8.3)
Requirement already satisfied: scipy in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from python-picard) (1.9.1)
Requirement already satisfied: scikit-learn in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from python-picard) (1.0.2)
Requirement already satisfied: packaging in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from numexpr-&gt;python-picard) (21.3)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from scikit-learn-&gt;python-picard) (2.2.0)
Requirement already satisfied: joblib&gt;=0.11 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from scikit-learn-&gt;python-picard) (1.1.0)
Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /Users/sebouithol/opt/anaconda3/lib/python3.9/site-packages (from packaging-&gt;numexpr-&gt;python-picard) (3.0.9)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
</section>
<section id="loading-the-data">
<h2>Loading the data<a class="headerlink" href="#loading-the-data" title="Permalink to this heading">#</a></h2>
<p>Now we want to create an array with the content of the eeg data file. We do this using the command read_raw_bdf. This command is part of the MNE toolbox, and within MNE of the io (input-output) library, so the full command will read as: nameArray = mne.io.read_raw(“file name”). We set preload to <em>True</em>, which means that the entire file (390MB will be loaded into the memory. This will result in faster processing, but requires more RAM. If your computer does not have much memory, you may want to set this to <em>False</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;Flanker_EEG_52_12052022.bdf&quot;</span>

<span class="n">raw_eeg</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_bdf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extracting EDF parameters from /Users/sebouithol/DataspellProjects/Experimentation2DataAnalysis/Experimentation2/Flanker_EEG_52_12052022.bdf...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BDF file detected
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">ym</span><span class="o">/</span><span class="n">sgmmtl6j62gdmqhqjzgb95_00000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_82677</span><span class="o">/</span><span class="mf">83885273.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;Flanker_EEG_52_12052022.bdf&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">raw_eeg</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_bdf</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/mne/io/edf/edf.py</span> in <span class="ni">read_raw_bdf</span><span class="nt">(input_fname, eog, misc, stim_channel, exclude, infer_types, include, preload, units, encoding, verbose)</span>
<span class="g g-Whitespace">   </span><span class="mi">1711</span>     <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s2">&quot;bdf&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1712</span>         <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only BDF files are supported, got </span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1713</span>     <span class="k">return</span> <span class="n">RawEDF</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1714</span>         <span class="n">input_fname</span><span class="o">=</span><span class="n">input_fname</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1715</span>         <span class="n">eog</span><span class="o">=</span><span class="n">eog</span><span class="p">,</span>

<span class="nn">&lt;decorator-gen-253&gt;</span> in <span class="ni">__init__</span><span class="nt">(self, input_fname, eog, misc, stim_channel, exclude, infer_types, preload, include, units, encoding, verbose)</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/mne/io/edf/edf.py</span> in <span class="ni">__init__</span><span class="nt">(self, input_fname, eog, misc, stim_channel, exclude, infer_types, preload, include, units, encoding, verbose)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>         <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting EDF parameters from </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_fname</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>         <span class="n">input_fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">input_fname</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">153</span>         <span class="n">info</span><span class="p">,</span> <span class="n">edf_info</span><span class="p">,</span> <span class="n">orig_units</span> <span class="o">=</span> <span class="n">_get_info</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span>             <span class="n">input_fname</span><span class="p">,</span> <span class="n">stim_channel</span><span class="p">,</span> <span class="n">eog</span><span class="p">,</span> <span class="n">misc</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">infer_types</span><span class="p">,</span> <span class="n">preload</span><span class="p">,</span> <span class="n">include</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span>         <span class="p">)</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/mne/io/edf/edf.py</span> in <span class="ni">_get_info</span><span class="nt">(fname, stim_channel, eog, misc, exclude, infer_types, preload, include)</span>
<span class="g g-Whitespace">    </span><span class="mi">487</span>     <span class="n">misc</span> <span class="o">=</span> <span class="n">misc</span> <span class="k">if</span> <span class="n">misc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span> 
<span class="ne">--&gt; </span><span class="mi">489</span>     <span class="n">edf_info</span><span class="p">,</span> <span class="n">orig_units</span> <span class="o">=</span> <span class="n">_read_header</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">infer_types</span><span class="p">,</span> <span class="n">include</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span> 
<span class="g g-Whitespace">    </span><span class="mi">491</span>     <span class="c1"># XXX: `tal_ch_names` to pass to `_check_stim_channel` should be computed</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/mne/io/edf/edf.py</span> in <span class="ni">_read_header</span><span class="nt">(fname, exclude, infer_types, include)</span>
<span class="g g-Whitespace">    </span><span class="mi">471</span>     <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> file detected&quot;</span> <span class="o">%</span> <span class="n">ext</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">472</span>     <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;bdf&quot;</span><span class="p">,</span> <span class="s2">&quot;edf&quot;</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">473</span>         <span class="k">return</span> <span class="n">_read_edf_header</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">infer_types</span><span class="p">,</span> <span class="n">include</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">474</span>     <span class="k">elif</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;gdf&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">475</span>         <span class="k">return</span> <span class="n">_read_gdf_header</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">exclude</span><span class="p">,</span> <span class="n">include</span><span class="p">),</span> <span class="kc">None</span>

<span class="nn">~/opt/anaconda3/lib/python3.9/site-packages/mne/io/edf/edf.py</span> in <span class="ni">_read_edf_header</span><span class="nt">(fname, exclude, infer_types, include)</span>
<span class="g g-Whitespace">    </span><span class="mi">719</span>     <span class="n">edf_info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="g g-Whitespace">    </span><span class="mi">720</span> 
<span class="ne">--&gt; </span><span class="mi">721</span>     <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">722</span>         <span class="n">fid</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># version (unused here)</span>
<span class="g g-Whitespace">    </span><span class="mi">723</span> 

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/Users/sebouithol/DataspellProjects/Experimentation2DataAnalysis/Experimentation2/Flanker_EEG_52_12052022.bdf&#39;
</pre></div>
</div>
</div>
</div>
<p>We have managed to import the eeg data in python. At this point we may want to check what kind of data we have imported, so we use the command <em>info</em>. Python is an object-oriented programming language, so we can use our variable name, raw_eeg, and add .info to it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_eeg</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
</div>
<p>The info displayed above is what is stored in the header of the file. You can see, for instance, that 72 electrodes have been used (twice the number that we’ve used in the data acquisition practical); That the recording took almost an hour, and that the analogue signal was sampled with a 512Hz frequency.
The data file itself is little more than the measured potential of a number of electrodes sampled at given frequency, stored as a very large 2-dimensional matrix. The size if the matrix is the number of channels for one dimension, and the sampling frequency timed the duration of the recording in seconds.</p>
<p>To make sense of this matrix, we will also have to specify what the locations of each of the electrodes is. Luckily we do not have to do this by hand. MNE has dictionaries (or rather atlases) of standard systems. Ours is called <em>biosemi64</em>: BioSemi is the brand of the EEG setup; 64 denotes the number of channels. If we use this atlas, the location of each of the electrodes is provided. Additionally, we will specify that EXG1 through EXG6 are not used for recording the eeg signal, but were additional electrodes used for reference and tracking eye movements (eog channels). We will drop EXG7 and EXG8, as they were not used during the recording.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">biosemi_montage</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">make_standard_montage</span><span class="p">(</span><span class="s2">&quot;biosemi64&quot;</span><span class="p">)</span>
<span class="n">raw_eeg</span><span class="o">.</span><span class="n">set_montage</span><span class="p">(</span><span class="n">biosemi_montage</span><span class="p">,</span> <span class="n">on_missing</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">raw_eeg</span><span class="o">.</span><span class="n">set_channel_types</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;EXG1&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG2&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG3&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG4&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG5&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG6&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">})</span>
<span class="n">raw_eeg</span><span class="o">.</span><span class="n">drop_channels</span><span class="p">([</span><span class="s1">&#39;EXG7&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG8&#39;</span><span class="p">])</span>  <span class="c1"># Unused channels</span>
</pre></div>
</div>
</div>
</div>
<p>If you want to check the location of the sensors, you can use the plot_sensors command. Do you recognise the naming and location convention?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_eeg</span><span class="o">.</span><span class="n">plot_sensors</span><span class="p">(</span><span class="n">show_names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#fig = raw.plot_sensors(&quot;3d&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p>We have loaded the data, and specified some of the characteristics. Now it is time to preprocess the data.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="preprocessing">
<h1>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this heading">#</a></h1>
<p>EEG preprocessing encompasses multiple steps. Generally, these steps are different in every experiment, as they are dependent on the research question, the recording setup, and the subsequent analysis steps. So there is no one-size-fits-all method. The steps below are common in many analysis pipelines.</p>
<section id="downsampling">
<h2>Downsampling<a class="headerlink" href="#downsampling" title="Permalink to this heading">#</a></h2>
<p>In the output above we saw all that the signal was sampled with a 512Hz frequency. For our purpose this is a bit too high, which will make files unnecessarily big, and computations slow. So we will <em>downsample</em> the data. This will be done using the resample command. We will have to specify the sfreq for this. Note that we could have recorded this data with a sampling frequency of 250 from the start, which would have saved us the downsampling step. Yet, this latter option would have resulted in data of lesser quality. Do you understand why? Have a look at the command below. Do you understand the syntaxis? What is raw_eeg doing at both sides of the ‘=’ sign?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_eeg</span> <span class="o">=</span> <span class="n">raw_eeg</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">sfreq</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you want to check whether it was successful you can use the .info command again</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_eeg</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="rereferencing">
<h2>Rereferencing<a class="headerlink" href="#rereferencing" title="Permalink to this heading">#</a></h2>
<p>You may remember from the lecture that the potential that is recorded at each electrode is not an absolute value, but always a difference between that electrode and another electrode. You may also remember that during the acquisition we have used two electrodes named ‘drl’ and ‘cms’ as a reference during recording, and that we placed two electrodes on the mastoids in addition. Since drl and cms were close to the active electrodes, they are not an ideal reference for analysing the data. The mastoids are further away from the active electrodes, and not near the brain, which will make them a superior reference. We will set the average of these two channels as explicit reference for all the other electrodes. Can you explain the procedure? Could we have placed cms and drl directly on the mastoids?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_eeg</span><span class="o">.</span><span class="n">set_eeg_reference</span><span class="p">(</span><span class="n">ref_channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EXG5&#39;</span><span class="p">,</span> <span class="s1">&#39;EXG6&#39;</span><span class="p">])</span>  <span class="c1"># Take average of mastoids as reference</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s have a quick inspection of what the raw data looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_raw</span><span class="p">(</span><span class="n">raw_eeg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ok, it is clearly data, but it does not very  look pretty. It still contains various types of noise, and at multiple places the recorded value is too small or large to be displayed in the given range. In different steps we will correct these problems.</p>
</section>
<section id="filtering">
<h2>Filtering<a class="headerlink" href="#filtering" title="Permalink to this heading">#</a></h2>
<p>The EEG signal can be constructed as an assembly of sinus waves of different frequencies, phase, and strength (a Fourrier Analysis). Of some of these frequencies, the very low and very high ones, we can be sure that they do not correlate to brain activity. Low frequencies may be attributed to amplifier drift, or sweat. We use a so-called <em>high-pass</em> filter to discard this frequencies High pass means that frequencies higher than a certain threshold can ‘pass’ the filters; lower frequencies are filtered out.
Higher frequencies we filter out using a <em>low-pass filter</em>. There is some controversy around the source of high frequencies in the EEG signal. We are certain that line noise (50Hz in Europe) and muscle activation contribute to this frequency range, but there seems to be evidence that higher frequencies can also originate from the brain. So you have to choose the threshold frequency of your low-pass filter wisely, dependent on your research question.</p>
<p>Note that the names of the two filters always cause confusion. The value of a low-pass filter is always higher than that of a high-pass filter. Check whether you can explain why.</p>
<p>Here we will use a high pass setting of 0.1 Hz. This is relatively conservative filtering (everything slower than 10 second oscillations will be removed), but choose this setting because our independent component analysis will work better this way. We can of course choose to do another filtering step after the ICA. If you try you will see that your data will already look a bit better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_cut</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">high_cut</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">filtered_eeg</span> <span class="o">=</span> <span class="n">raw_eeg</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">low_cut</span><span class="p">,</span> <span class="n">high_cut</span><span class="p">,</span> <span class="n">fir_design</span><span class="o">=</span><span class="s1">&#39;firwin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s have a look at what the data looks like now. Use the same plot command as above, but this time plot the new array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_raw</span><span class="p">(</span><span class="n">filtered_eeg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This already looks a bit better, but we still need to remove the artifacts that originate from eye movements (blinks and saccades). We will do this using an <em>Independent Component Analysis</em>.</p>
<section id="independent-component-anlysis">
<h3>Independent Component Anlysis<a class="headerlink" href="#independent-component-anlysis" title="Permalink to this heading">#</a></h3>
<p>To understand an Independent Component Analysis (ICA), think of a number of musicians playing in a room, while being recorded by multiple microphones. Each microphone picks up the sound of all the musical instruments, but, importantly, at different strengths. An ICA is a mathematical procedure to re-construct the sound of each individual instrument based on the signals of each of the microphones (test yourself: what problem does an ICA have to solve?). The number of instruments that can thus be isolated is limited by the number of microphones.
Back to EEG data preprocessing: The raw signal is composed of proper brain activation as well as artifacts such as eye-blinks and saccades. What we want to do is identify components that can be related to occular artifacts, and then subtract these components from the raw signal. What would be left is a signal that does not include the contribution of these noise components. Here the number of components that can be estimated is limited by the number of electrodes. Since this data was recorded using 64 channels, we have ample components at our disposal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mne.preprocessing</span> <span class="kn">import</span> <span class="n">ICA</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;picard&#39;</span>

<span class="n">n_components</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># select n_components by explained variance of PCA</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">23</span> <span class="c1"># Random seed</span>

<span class="n">ica</span> <span class="o">=</span> <span class="n">ICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<span class="n">ica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">filtered_eeg</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let us plot these components for a visual inspection. The components are ranked ordinally, the first component explaining the most of the variance in the data, the last component the least. We can plot the contribution of the different components over time, but also the location of the component.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">plot_components</span><span class="p">()</span>
<span class="n">ica</span><span class="o">.</span><span class="n">plot_sources</span><span class="p">(</span><span class="n">filtered_eeg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For best results we look at both the components and the sources. Note that the sources graph does not display the electrodes, but the different components. The graph indicates how much of the (in our case filtered eeg) signal is explained by each component. What component correlates with eye blinks, you think? Why? What component could correlate to a bad sensor connection? Why? We will remove it from the data.</p>
<p>Fill in the components number in the brackets below. Mind that the first member in an array in python is referred to as 0 (unlike for instance MatLab and R, where the first member is 1). Type in the components between the square brackets, separated by a comma</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cleaned_eeg</span> <span class="o">=</span> <span class="n">ica</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filtered_eeg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_raw</span><span class="p">(</span><span class="n">cleaned_eeg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="filtering-again">
<h2>Filtering again<a class="headerlink" href="#filtering-again" title="Permalink to this heading">#</a></h2>
<p>That looks a whole lot better! Remember that we filtered quite conservatively because of the ICA that we planned to do. We can do another, slightly less conservative round of filtering to get rid of the frequencies between 0.1 and 1 Hz. They are certainly not related to brain activity, so better discarded. These steps and settings can  be changed and even repeated, as we do here, as long as you are transparent about it when publishing the results.</p>
<p>So now we run another band pass filter, but this time with the low_cut set to 1, and we plot the results immediately.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_cut</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">high_cut</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">cleaned_eeg</span> <span class="o">=</span> <span class="n">cleaned_eeg</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">low_cut</span><span class="p">,</span> <span class="n">high_cut</span><span class="p">,</span> <span class="n">fir_design</span><span class="o">=</span><span class="s1">&#39;firwin&#39;</span><span class="p">)</span>
<span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_raw</span><span class="p">(</span><span class="n">cleaned_eeg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This is starting to look like nice usable data! Now it is time to relate it to behavioural events</p>
</section>
<section id="loading-the-behavioural-data">
<h2>Loading the behavioural data<a class="headerlink" href="#loading-the-behavioural-data" title="Permalink to this heading">#</a></h2>
<p>Because MNE is a python toolbox, the possibilities to combine eeg with behavioural data are unlimited. In this case, the behavioural data is stored in a separate text file. I will not explain this step in detail, as it is very specific to the experiment, but have a look at the code, and see whether you understand what is happening. Crucial is that in this task on half of the trials the participant was given an alert on beforehand, and on half of the trials this alert was absent, like with the classical Flankers task.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fileNameBehav</span> <span class="o">=</span> <span class="s2">&quot;flankertask_eyetracker_52_202205121431_format.txt&quot;</span>

<span class="c1"># Load in behavioral data and make numpy array of trialtype</span>
<span class="n">trials</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fileNameBehav</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">trials</span><span class="p">[</span><span class="s1">&#39;RT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Replace &quot;none&quot; answers with &quot;nan&quot; for int processing</span>
<span class="n">trials</span><span class="p">[</span><span class="s1">&#39;RT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">trials</span><span class="p">[</span><span class="s1">&#39;RT&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">,</span> <span class="n">downcast</span><span class="o">=</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>

<span class="n">trials</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trials</span><span class="p">[</span><span class="s1">&#39;trialtype&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">trials</span><span class="p">[</span>
    <span class="s1">&#39;alert&#39;</span><span class="p">]</span>  <span class="c1"># Make condition column, with alert and trialtype</span>
<span class="n">trials_num</span> <span class="o">=</span> <span class="n">trials</span><span class="p">[[</span><span class="s1">&#39;condition&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="c1"># Change coding of trialtype, and reshape to appropriate dimension for later processing</span>
<span class="n">trials_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">trials_num</span> <span class="o">==</span> <span class="s2">&quot;congruent alert&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">trials_num</span><span class="p">)</span>
<span class="n">trials_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">trials_num</span> <span class="o">==</span> <span class="s2">&quot;congruent no_alert&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">trials_num</span><span class="p">)</span>
<span class="n">trials_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">trials_num</span> <span class="o">==</span> <span class="s2">&quot;incongruent alert&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">trials_num</span><span class="p">)</span>
<span class="n">trials_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">trials_num</span> <span class="o">==</span> <span class="s2">&quot;incongruent no_alert&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">trials_num</span><span class="p">)</span>
<span class="n">trials_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">trials_num</span> <span class="o">==</span> <span class="s2">&quot;catch alert&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">trials_num</span><span class="p">)</span>
<span class="n">trials_num</span> <span class="o">=</span> <span class="n">trials_num</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">720</span><span class="p">)</span>

<span class="c1"># Transfer the stimulus EEG triggers to an MNE event file</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">find_events</span><span class="p">(</span><span class="n">raw_eeg</span><span class="p">,</span> <span class="n">uint_cast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">consecutive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Delete all markers except for &quot;alert_onset&quot; (34) --&gt; we will use that to orient ourselves</span>
<span class="c1"># Note that there were also &quot;alert_onset&quot; triggers in no_alert trials, these were just silent</span>
<span class="n">events_trials</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">pick_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">253</span><span class="p">])</span>

<span class="c1"># Merge trials_num and events_trials: replace third column np array with trials_num that contain trial condition</span>
<span class="n">events_trials</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">trials_num</span>

<span class="c1"># alert-centered to flanker centered (+500)</span>
<span class="n">events_trials</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">events_trials</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">500</span> <span class="o">*</span> <span class="p">(</span><span class="n">raw_eeg</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">))</span>
<span class="c1"># Dictionary of numbers</span>
<span class="n">event_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;congruent alert&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;congruent no_alert&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
              <span class="s2">&quot;incongruent alert&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;incongruent no_alert&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
              <span class="s2">&quot;catch alert&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>The behavioural data tells us what event occured at what time. We can use it to cut the continuous signal into chunks of data that are linked to one of the experimental condition. We call these chunks <em>epochs</em>. We use the behavioural data that we have loaded above to define the epochs. We specify how much time before, and how much time after the event we want to include into our epoch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmin</span><span class="o">=-</span><span class="mf">0.6</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># epoch from 0.6s before flanker onset to 0.7s after it</span>

<span class="n">epochs</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span><span class="p">(</span><span class="n">cleaned_eeg</span><span class="p">,</span> <span class="n">events_trials</span><span class="p">,</span> <span class="n">event_dict</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">metadata</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now plot the epochs using the epochs.plot command (mind the capital E here!)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epochs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">)</span>
<span class="c1">#mne.Epochs.plot(epochs)</span>
</pre></div>
</div>
</div>
</div>
<p>Now it is time to make averages of all epochs belonging to one condition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">congNoAl</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;congruent no_alert&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">incongNoAl</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;incongruent no_alert&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">congAl</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;congruent alert&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<span class="n">incongAl</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;incongruent alert&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>and again, we can plot them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">congNoAl</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Look at the plots carefully. What is shown is the ERP for every electrode overlayed on top of each other. Two observations may need explication. 1) The ERP is visible in every electrode, especially the positive peak at 400ms. This is inherent to EEG data and its poor spatial resolution. If we want to do source localisation we will have to use the difference between the ERP peaks and troughs of the various electrodes. You can see that during the positive peak at around 200ms, the spread over the scalp is quite good, with the greenish tints (frontal electrodes) are more positive thah the blue/purpel electrodes (what does that mean?). 2) The ERP components are much larger than the noise before 0s. This means that our recording and preprocessing step was succesfull and that the signal-to-noise ration is likely to be good enough to do analyses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evokeds</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">congruentAlert</span><span class="o">=</span><span class="n">congAl</span><span class="p">,</span> <span class="n">incongruentAlert</span><span class="o">=</span><span class="n">incongAl</span><span class="p">,</span> <span class="n">congruentNoAlert</span><span class="o">=</span><span class="n">congNoAl</span><span class="p">,</span> <span class="n">incongruentNoAlert</span><span class="o">=</span><span class="n">incongNoAl</span><span class="p">)</span>
<span class="n">picks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Cz&quot;</span><span class="p">]</span>
<span class="n">mne</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">plot_compare_evokeds</span><span class="p">(</span><span class="n">evokeds</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can see that the difference between alert and no alert conditions is big at around 300ms before stimulus onset, but virtually absent in the peaks +400ms. In this peak we can see a difference between the congruent and incongruent conditions, irrespective of the alert.</p>
<p>The Tutorial ends here. If you want you can play with the settings of the commands above, or add new commands below. I started a time-frequency analysis below, but it is not yet the way I want it to be. You can play with it and see what it does. Alternatively, you can add your own commands that you looked up at the MNE website.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_eeg</span><span class="o">.</span><span class="n">compute_psd</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw_eeg</span><span class="o">.</span><span class="n">compute_psd</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">power</span><span class="p">,</span> <span class="n">itc</span> <span class="o">=</span> <span class="n">mne</span><span class="o">.</span><span class="n">time_frequency</span><span class="o">.</span><span class="n">tfr_morlet</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">return_itc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">freqs</span><span class="o">=</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Analysing data with Python and MNE</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-mne">About MNE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-tutorial">About this tutorial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing">Importing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-data">Loading the data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downsampling">Downsampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rereferencing">Rereferencing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">Filtering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-anlysis">Independent Component Anlysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-again">Filtering again</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-the-behavioural-data">Loading the behavioural data</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>